<!DOCTYPE html>
<html> 
<head> 
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
	<title>OptimiSer</title> 
	<link rel="stylesheet" type="text/css" href="tabstyles.css">
	<link rel="stylesheet" type="text/css" href="main.css">

	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places,visualization"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script type="text/javascript">

		

		
      function initialize() {
      	var markers = [];
        var mapOptions = {
          center: { lat: 42.359254, lng: -71.093134},
          zoom: 17
        };

        var map = new google.maps.Map(document.getElementById('map'),
            mapOptions);

        var input = (document.getElementById('pac-input'));
		map.controls[google.maps.ControlPosition.TOP_LEFT].push(input); //link google maps search function to the input field
		var searchBox = new google.maps.places.SearchBox((input));

		google.maps.event.addListener(searchBox, 'places_changed', function() {
		    var places = searchBox.getPlaces();

		    if (places.length == 0) {
		      return;
		    }
		    for (var i = 0, marker; marker = markers[i]; i++) {
		      marker.setMap(null);
		    }

		    // For each place, get the icon, place name, and location.
		    markers = [];
		    var bounds = new google.maps.LatLngBounds();
		    for (var i = 0, place; place = places[i]; i++) {
		      var image = {
		        url: place.icon,
		        size: new google.maps.Size(71, 71),
		        origin: new google.maps.Point(0, 0),
		        anchor: new google.maps.Point(17, 34),
		        scaledSize: new google.maps.Size(25, 25)
		      };

		      // Create a marker for each place.
		      var marker = new google.maps.Marker({
		        map: map,
		        icon: image,
		        title: place.name,
		        position: place.geometry.location
		      });

		      markers.push(marker);

		      bounds.extend(place.geometry.location);
		    }

		    map.fitBounds(bounds);
		});

		google.maps.event.addListener(map, 'bounds_changed', function() {
			var bounds = map.getBounds();
			searchBox.setBounds(bounds);
		});

		var heatMapEveryoneData = [
		  {location: new google.maps.LatLng(42.359749, -71.094359), weight: 0.5},
		  new google.maps.LatLng(42.357184, -71.100963),
		  {location: new google.maps.LatLng(42.354833, -71.101483), weight: 2},
		  {location: new google.maps.LatLng(42.355701, -71.099364), weight: 3},
		  {location: new google.maps.LatLng(42.359122, -71.088287), weight: 2},
		  new google.maps.LatLng(42.356157, -71.097299),
		  {location: new google.maps.LatLng(42.360804,  -71.084427), weight: 0.5},

		  {location: new google.maps.LatLng(42.359950, -71.086018), weight: 3},
		  {location: new google.maps.LatLng(42.351504, -71.087694), weight: 2},
		  new google.maps.LatLng(42.350880, -71.088469),
		  {location: new google.maps.LatLng(42.350927, -71.089942), weight: 0.5},
		  new google.maps.LatLng(42.359743, -71.101848),
		  {location: new google.maps.LatLng(42.360296, -71.102811), weight: 2},
		  {location: new google.maps.LatLng(42.362507, -71.086605), weight: 3}
		];

		var heatMapJustMeData = [
		  new google.maps.LatLng(42.357184, -71.100963),
		  {location: new google.maps.LatLng(42.359122, -71.088287), weight: 2},
		  new google.maps.LatLng(42.356157, -71.097299),
		  {location: new google.maps.LatLng(42.351504, -71.087694), weight: 2},
		  new google.maps.LatLng(42.350880, -71.088469),
		  new google.maps.LatLng(42.359743, -71.101848),
		  {location: new google.maps.LatLng(42.360296, -71.102811), weight: 2},
		  {location: new google.maps.LatLng(42.362507, -71.086605), weight: 2}

		];

    	var heatmapEveryone = new google.maps.visualization.HeatmapLayer({
			data: heatMapEveryoneData,
			radius: 20
		});

		var heatmapJustMe = new google.maps.visualization.HeatmapLayer({
			data: heatMapJustMeData,
			radius: 20
		});

		$(document).ready(function(){
			// Everyone/justme tab functionality
			var leftTab = $("#leftButton");
			var rightTab = $("#rightButton");
			leftTab.addClass("selected");
			
			heatmapEveryone.setMap(map);
			leftTab.bind("click", function(){
				leftTab.addClass("selected");
				rightTab.removeClass("selected");

				heatmapJustMe.setMap(null);
				heatmapEveryone.setMap(map);
			});

			rightTab.bind("click", function(){
				rightTab.addClass("selected");
				leftTab.removeClass("selected");

				heatmapEveryone.setMap(null);
				heatmapJustMe.setMap(map);
			});

			var pickupButton = $("#pickupDropoff");
			var cancelButton = $("#cancel");

			cancelButton.css("width", 0);
			cancelButton.hide();

			var canPickUp = true; //boolean to determine whether or not you can pick up someone right now

			pickupButton.bind("click", function(){
				if (canPickUp){
					pickupButton.text("Drop Off");
					cancelButton.css("width", 95);
					cancelButton.show("slow");
					pickupButton.css("width", 395);
					pickupButton.css("background-color", "#6297f2");
					canPickUp = false;
				} else {
					pickupButton.text("Pick Up");
					cancelButton.css("width", 0);
					cancelButton.hide();
					pickupButton.css("width", 500);
					pickupButton.css("background-color", "green");
					canPickUp = true;
				}
			});

		});


      }
      google.maps.event.addDomListener(window, 'load', initialize);


      

      
    </script>
</head> 
<body>
	<div class="Tabs segmentedControlBase" id="buttonContainer">
		<div class="button segmentedControl leftEnd tab" id="leftButton">All Rider History</div>
    	<div class="button segmentedControl rightEnd tab" id="rightButton">My Rider History</div>
	</div>
	<div class="rounded">
		<input id="pac-input" class="controls" type="text" placeholder="Search Box">
		<div id="map"></div>
	</div>
	<div id="dropoffContainer">
		<div class="rounded" id = "pickupDropoff">Pick Up</div>
		<div class="rounded" id = "cancel">&#215;  Cancel</div>
	</div>
</body>
</html>